# LightEdit – Android 图片编辑应用（TT-IC-Camera 客户端工程训练营考察作业）

本项目是 **「客户端工程训练营考察作业（TT-IC-Camera）」** 的 Android 端实现，目标是开发一款基于 Kotlin 的轻量级图片编辑 App，覆盖从 **相册选图 / 相机拍照 → 图像编辑 → 保存到相册（带水印）** 的完整链路。

项目除了实现要求中的所有核心功能外，还重点体现：

- 工程化流程：Git 工作流、规范化分支、Issue & 看板管理  
- 模块化架构：UI / Data / Editor / Core 分层  
- 文档与设计：需求、架构、UML、测试、学习总结等完整技术文档  

> 截止时间：**2024-12-04**（在此之前完成全部功能、测试与集成，并提交 GitHub 仓库 + 文档 + 视频）

---

## 1. 项目背景与目标

### 1.1 项目背景

在移动互联网时代，图片编辑工具广泛应用于社交分享、工作汇报和创意设计等场景。本作业以 **“轻量高效、功能实用、体验流畅”** 为核心定位，要求完成一个面向大众用户的图片编辑 App。

### 1.2 项目目标

- **技术目标**
  - 熟练使用 **Kotlin + Android** 完成客户端开发；
  - 实现图像的加载、处理、保存等核心能力；
  - 掌握性能优化（相册流畅度、编辑响应速度、内存控制等）；
  - 正确处理权限、存储失败、无相机等异常场景。

- **产品目标**
  - 实现一款功能完整、操作简洁、运行稳定的图片编辑工具；
  - 满足用户基础编辑需求（裁剪、旋转、文字、调节等）；
  - 拥有良好的易用性与一定的扩展性（支持加分功能扩展）。

---

## 2. 技术栈与架构

### 2.1 技术栈

- **平台**：Android（目标兼容 Android 10 及以上）
- **开发语言**：Kotlin
- **IDE & 工具**：Android Studio, Gradle
- **核心框架 / 组件**
  - Activity + Jetpack Fragment
  - ViewModel（用于状态管理，视复杂度选择性使用）
  - MediaStore（相册读取与保存）
  - CameraX（推荐，用于相机拍照）
- **第三方库（仅用于辅助，不负责核心编辑逻辑）**
  - Coil / Glide：相册缩略图异步加载（裁剪为正方形）
  - 运行时权限库（如有使用，会在技术文档中说明）
- **手动实现部分**
  - 相册核心逻辑（相册扫描、分组、缩略图处理）
  - 编辑算法：裁剪、旋转、翻转、亮度/对比度、文字叠加
  - 基本滤镜（如实现加分项）
  - 合成与保存（含水印绘制）

> 关于 iOS 端：作业要求中包含 iOS 兼容性，但本仓库专注 **Android 客户端实现**。iOS 相关内容将只在技术文档中进行架构和跨平台设计层面的简要讨论，不做实际实现。

---

## 3. 功能概览

详细功能需求请参考 `docs/requirements.md`，这里简要列出核心功能：

### 3.1 核心功能（必做）

1. **相册选图**
   - 加载本地图片资源；
   - 两个 Tab：
     - 全部图片；
     - 按文件夹归类；
   - 相册权限申请 + 无权限 / 相册为空等异常处理；
   - 缩略图异步加载，并裁剪为正方形；
   - 图片大图预览；
   - 从单张图片进入编辑界面。

2. **相机拍照**
   - 使用 CameraX 或系统相机完成拍照；
   - 拍照后图片直接导入编辑界面；
   - 相机权限申请；
   - 无相机设备异常处理（如部分模拟器）。

3. **图片缩放**
   - 导入图片后自动适配编辑区域；
   - 支持双指缩放，缩放范围 0.5x – 2x；
   - 支持拖动平移查看图像细节。

4. **图片裁剪**
   - 自由裁剪；
   - 固定比例裁剪：1:1、4:3、16:9、3:4、9:16；
   - 支持拖动裁剪框调整范围与位置；
   - 裁剪后图像清晰、无明显畸变。

5. **旋转与翻转**
   - 90° 顺时针；
   - 90° 逆时针；
   - 180° 旋转；
   - 水平翻转 / 垂直翻转；
   - 操作实时预览。

6. **亮度与对比度调节**
   - 亮度范围：-100 ~ 100；
   - 对比度范围：-50 ~ 150；
   - 默认值为 0；
   - 拖动滑条实时更新图像显示。

7. **文字编辑模块**
   - 在图片上添加文本；
   - 文本内容可自定义输入，支持换行。

8. **文字样式调节**
   - 字体：至少 3 种；
   - 字号：12–36 号可调；
   - 颜色：支持 RGB 调色或预设 ≥10 种颜色；
   - 透明度：50%–100% 可调。

9. **文字操作**
   - 拖动文本到任意位置；
   - 双指缩放文字；
   - 旋转文字角度（0–360°）。

10. **保存模块**
    - 编辑完成后保存到本地相册；
    - 存储权限申请；
    - 存储失败异常处理（例如空间不足）；
    - 保存成功时给出明确提示；
    - 保存时在图像上添加水印文字：**“训练营”**。

---

### 3.2 加分功能（计划按时间择机实现）

> 是否实现视进度而定，但架构会预留扩展点。

1. 动画过渡：从相册缩略图到大图预览之间的平滑缩放与位移动画；
2. 滤镜功能：至少 6 种滤镜（原图、黑白、复古、清新、暖色、冷色），滤镜算法手动实现；
3. 贴纸功能：≥10 个贴纸，支持拖动、缩放、旋转、删除、层级调整；
4. 图像拼接：2–4 张图片的横向、纵向、2×2 拼接；
5. 夜间模式：日间 / 夜间主题切换；
6. 分享模块：一键分享至抖音（包含失败异常处理）。

---

## 4. 项目结构（规划）

> 实际代码结构可能会随开发略有调整，但整体分层不变。

app/
 └── src/main/java/com/owenzx/lightedit/
     ├── ui/
     │   ├── main/           # MainActivity & 导航
     │   ├── album/          # 相册列表 & 文件夹 Tab & 预览
     │   ├── camera/         # CameraX 拍照
     │   └── editor/         # 编辑器（缩放 / 裁剪 / 旋转 / 调色 / 文字）
     │       ├── crop/       # 裁剪 Overlay & 比例逻辑
     │       ├── text/       # TextOverlayView & TextElement（文字叠加）
     │       └── view/       # ZoomableImageView 等自定义 View
     ├── data/               # 媒体加载、保存相关
     └── core/               # 通用工具类、扩展函数等

详细架构设计与 UML 类图、时序图将记录在：`docs/architecture.md`

## 5. 性能与体验目标

根据作业中的性能评审标准，本项目制定如下性能与体验目标：

### 5.1 相册性能
- 相册页面启动时间 ≤ 1 秒；
- 滑动过程中保持稳定流畅，帧率 ≥ 30fps；
- 缩略图采用异步加载 + 正方形裁剪策略，避免一次性加载过多图片引发卡顿；
- 异步加载过程中提供占位图，避免闪烁。

### 5.2 编辑性能
- 从相册或相机进入编辑界面过程 ≤ 1 秒；
- 调整亮度/对比度实时响应，延迟 ≤ 0.5 秒；
- 核心编辑算法（裁剪、旋转、翻转、文字叠加）均采用 Bitmap + Canvas 手动实现，保证可控性与性能。

### 5.3 内存与稳定性
- 编辑单张 ≤10MB 图片时，App 内存占用 ≤ 200MB；
- 避免频繁复制 Bitmap，尽可能使用同一张 Bitmap 管理；
- 全程监控潜在内存泄漏，确保连续编辑 10 张图片不闪退；
- 图片编辑过程中，严格控制 Bitmap 缓存与及时回收。

### 5.4 界面与交互体验
- 核心按钮醒目，布局清晰；
- 手势操作（缩放 / 拖动 / 旋转）无明显延迟；
- 图片编辑操作提供实时预览反馈；
- 保证横竖屏切换时的自动适配，无布局错位。

---

## 6. 工程与 Git 流程

本项目遵循简化版 Git Flow，以满足工程化、可追溯、可维护等要求。

### 6.1 分支模型
- main：稳定可演示版本，最终提交所在分支；
- develop：日常集成分支；
- feature/*：按功能划分的开发分支，例如：
  - feature/album-loader
  - feature/album-preview
  - feature/camera-capture
  - feature/editor-crop
  - feature/editor-transform
  - feature/editor-text
  - feature/save-image

### 6.2 Commit Message 规范
采用简化 Angular 规范：
- feat：新功能
- fix：问题修复
- docs：文档变更
- refactor：重构
- chore：工具链或配置修改
示例：
feat: implement album media scanning
fix: correct crop rectangle mapping issue

### 6.3 Pull Request（PR）流程
1. 每个功能在独立 feature 分支开发；
2. 生成 PR 合并至 develop；
3. PR 内容需说明变更内容 + 测试情况；
4. 通过后删除该 feature 分支。

### 6.4 Tag 策略
采用语义化版本：
v1.0.0 - 最终提交版本
示例：
git tag -a v1.0.0 -m "Final submission"
git push origin v1.0.0

详细内容见 `docs/git-workflow.md`。

---

## 7. 项目计划（倒排至 2024-12-04）

本项目遵循倒排计划方式，确保在截止日期前完成所有开发、测试、文档与演示。

### 7.1 项目时间线概览
- 11/24：工程初始化 + Git + 文档
- 11/24–11/26：相册模块（全部图片、文件夹 Tab、缩略图、大图预览）
- 11/26–11/27：相机模块（CameraX）
- 11/27–11/29：编辑核心功能（缩放、裁剪、旋转、翻转）
- 11/30–12/01：亮度对比度、文字模块
- 12/02：保存模块 + 水印功能
- 12/03：测试、优化、性能调优
- 12/04：UML 文档、测试文档、学习总结、录制视频

### 7.2 详细计划
完整倒排计划见 `docs/planning.md`。

---

## 8. 文档索引（docs/ 目录）

本项目文档均位于 docs 目录下：

- requirements.md：详细需求文档（功能要求、性能要求、异常处理）
- git-workflow.md：分支策略、Commit 规范、PR 规范
- planning.md：从 11/22–12/04 的完整倒排计划
- architecture.md：整体架构说明、UML 类图、时序图
- learning-summary.md：学习与探索总结

---

## 9. License

本项目为课程作业，不提供公开 License。如需参考，请联系课程导师或按学术规范引用。
